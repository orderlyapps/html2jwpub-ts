//
//  test.swift
//  html2jwpub
//
//  Created by Dario Ragusa on 10/05/25.
//

import Foundation

//    [CyberChef example 1](https://gchq.github.io/CyberChef/#recipe=SHA2('256',64,160)From_Hex('Auto')XOR(%7B'option':'Hex','string':'11cbb5587e32846d4c26790c633da289f66fe5842a3a585ce1bc3a294af5ada7'%7D,'Standard',false)To_Hex('None',0)&input=MV93MjJfMjAyMl8yMDIyMDYwMA)
//    [CyberChef example 2](https://gchq.github.io/CyberChef/#recipe=AES_Decrypt(%7B'option':'Hex','string':'909fd5b41ddd8a75ac39c69604828a7d'%7D,%7B'option':'Hex','string':'3bc2c616d0ca2cff6dc4c0d7263a2327'%7D,'CBC','Hex','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D)Zlib_Inflate(0,0,'Adaptive',false,false)&input=ZjZhZmMwMTEzZmRiMzY4MDE4ZmEzYmEwZDUwNjJlZWFmNGJlNzVhY2Q2NDJkNzM0YTQ2N2M2OTNjODIyMWM2NzM4ODMwYzE0NDQwMjVkZWQ2ZTZmNGZiNjBjZjgyYzcwYWUyYTY5M2EyYTg3NjQ5NWVlMGMxZTU5MDE1NDcyODM0OTMyMGI1OWY2NDAwNzRjMDgzMzYxN2RhYzI5N2ZjZmI1NTY4ODhhMDgzOTAyZGZhYTgyZDNmNmY1MjZhMjI2NTJkZTlhYmEzZjU4NjRkM2RlOTQzMGU2N2Q4NmViNzQwYmUzM2MyNmFjMWVjMmZmNDg0MGE1ODRkYjdhMmMyM2I3Nzc5Y2FlZDNhZGZhZjQ5MzJhZWJhMjM4MDUxNTgzNjRkMjBhNGIxMGU3Njg3YjU4NzBjNDMzZWZmOTk2ZmJjMGI5NGRkYzRkMTI0YjA0NjU2NTUxMjVkZGNmNzI4ZjNlYTgxMDk5YjZkNGM1YjM5NTczM2U5OTZjNjE0YzgyMTA4MTZkNDc3MzViMjI4YzU0MWJiNGJhMTBkMDBlODVkZmVlODlmN2YzOTQ0Y2NmOTk2YWJmMDJkY2QyZTdkMzJlOTU0MGY3ZTVkMDUzMjE2OWFjZTM5ODk5MWI2YzMzYTlmZDdhYmUzMjMyYTU4ODIwYWZhNDFmOTdmMTU2YWI4YTExMzEzMjI5MjhkMDNhOWM4OTE4NGEzOTE5YTQ3NGM2YjM1MWM4MDg2NDkwYWM0ZDYyYTI3MDU2YWMzN2M2NTFmZjYxYmExMmJmZDRhNzk0YmQxNjNlNmM3MjRhYmY2ZjMxMTc1OTQyMDE4OWM3NjNkZGJjMGQxMzQ2Y2Q1ZDUyYjJiNzExYTg1MGY0NWI3MTk5NDIzNDIwNDRhZDVhYjMwMmY1ZGQzMWJjZjlhMjcwZjM4YTlmNmJlMWFjZDlkYzMxYTczYjE1YzBlNDcwNmYyYThjNDE3NmFiNzg1ODI4NDMyMjUwNzM0MzIxMzY1MWRhMTk5ODg5NTMyYzJiOTQyYTkwOTRjMDVlOWY2OGRjM2ExNmU0NTUzNTE4MTA4MzQzODk2YmRhZTA2ZTVmYjIxZDYzMzRjYjk4NmVmMzlkN2Q1MzQ3YTQwNWU3YzkzMGYzYTVlN2U1ZWM1MWY5MDk4OTNkYjg1ZGZlZjUzYTM3ODBhZWQ3OGNkNjRjM2EzMTdjNWM5MDkwZjYyYjNhMGVkMjZiODBlYWMxNzMxMmEzMDkxMzA0MTIxYmM1Mzc4ZTU3MGQ5MjVjMjcwMmYwNmY3ZWJlNTYwNGRmNDRmMjQ0YjA5MjYxODkyYTE0OTIyYzkxMTBhZTIyY2FkMzg1NmM3MDQ1NDlmMmYwNTVmNGI1Mjg0MDQwYzk5Y2I4ZGY2Y2Q4N2Q5NjA1MmIzYTJjY2IxYmE1ZWMxNTMyOWY2ZThlNmM2NjhjMjkyMjViMWMxN2YxYTVhN2MzZmQ0YmVmODRiMzYyYjJkOTg3NGUyMTIyNDUzYzUyMDA3OTFkOTFhYmZjMzU0YzkxMWJlMTY4NmFmNmIzYTJmMjBjZTc2MzBlZjRiMzJjYWExYzcyZTA2NzhlNDcwMTk2NTYzZTZlNTgxZTNjYjAwOTRlOGYyMWIyZTUxZWZjYTNlNDdkZDExN2YzNGFmZWJhNmI2ODJjY2FkZjhkM2Q2ZjE5MDVlNzIxN2JkZTVjMTU3ZThiMmExOWYyYWFiZGEwZTM3OGZkODA3MjgwNGVmNWJhN2ZjMTQzOTg1NmFjNDVkYjY1MDY1OTBkMDI0Zjc5YjY0Njk1ZWJiYTYyN2U2YTdmOTkzYzZlMmY3NDdhZGQ0MmYyOTQyMGVjMzc5NmJjNWU5M2QzNzAwNTg0NzM4ZDI2YmE3ODUzZTVlNjgzMmU0YzQ5NDM1MGI5MThjMTlmZTI1MmY1)

class Test {
    
    static func run() {
        let content = "04621fa6ff411eb9349c8c254826790b3d3163a169d22f9d62df5bfe7538889f1ed6f746a9e106af01939e02a7d25ae6aa0df09048424dc40ecb4ec7adebc7d63663a39577953fbc7477367874c0ee4c64ff9141708a78ed31b4c03cbdcaacc5676ce2b1a930d9fe45340bbdbd806a4db6af4b54370f5c9d04b933d5bc821a2e15297c93c440a5abc8fba6cfeda6f86398be4708937c3e0679ab84229e11edd068ddc8acf2f6fcd319933d7f6bcb8c068fe015ce37182aab31a05e1f8d6f0923bf03d8c0a0e62a8e713b4cfea7e4859fc8b52bfb748aea51c79c57564f241d584ca57145de5db7ba08377f1e473a5f75104eabeaa79527ea91a0f3dcba2d685e603d1297da3a0cb023d2be31f0e7b503646ad7d225ac69e23c5416dbc9b0c29fe3a099a58cd344bd4e4e657a0ab3ae3ca44617573899e75c9599205288ae19a74aed02ad37239847b6f6ba978cf158a7460880984ec8f595de875d2db3970896b1d7a221a6c19042af6b1268acaf9bd3216d1e03da62a4e48d9dfb996acc15e92270963a8b6a0a52bb5a03e1f45a8fdd6b8e61b27222eff0b28116794736b9e0576617b2fca1cfb194cb4ef17bb80da0dbabd45b3c41ca1ef1b9099860d62ae8a2119d8a033c4113d5a1e067c39b8d203d2ee4ef71db50d14eafab762d67d8fe0eeb6fed781dca07cf23dda4ee5c6036a91563215e1921e2b45c9b4bb74d7d5e4d7059b14d3af2fb3338889087498993f0ca7d6cf2d59a01a8236befd5c347ae6987dd5216abf6f51d0728d9e971b45f472ca5d3d78f341a585c21c4300f9aac2d200fe009ff8eee17d8ada68e9b6a58626189743a5a51edb08d44067e504b4d28a08da05ccc93ba6e7a12bdc3027cc3db762ea821cff2b7338fc92f915595bb95811c7d3e570ed08543bb65b23d1e2e76d97b6db042d0c95ae05f4898d36b70e758667c85a94ac12ab6145409408303193436b4c9619b0cad4cafa88ebe09f1b65a5be6928dd3e661ac371cf5e58b013ca1e18ccc3200cf76e2fafa09429911f8fe06fc4bdfac90f6bedde0eb9d318a1b9fde7cb9660c6513dc34029b4d85e8c7a4f73845b5b7837ce447bbf72f240a551f8b10fc97465f991a6d7de8350c08d2bf6fc9c9d0ec2d9a1f2293b2b733fcbd64369217d80526b3748bf55f764da1ca5a5c747c90535046d65606d4f75297"
        
        let jwpupAlgo = JwpubAlgorithm(MepsLanguageIndex: 4, Symbol: "w22", Year: 2022, IssueTagNumber: 20220600)
        var decryptedContent = jwpupAlgo.decrypt(content: Data(jwpupAlgo.hexStringToBytes(content)))
        print("Decrypted content:", decryptedContent)
        let encryptedContentData = jwpupAlgo.encrypt(content: decryptedContent)
        let encryptedContent = encryptedContentData.map { String(format: "%02hhx", $0) }.joined()
        print("Encrypted content:", encryptedContent)
        decryptedContent = jwpupAlgo.decrypt(content: Data(jwpupAlgo.hexStringToBytes(encryptedContent)))
        print("Decrypted content recheck:", decryptedContent)
    }
}
